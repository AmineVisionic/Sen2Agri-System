<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />

<!-- Bootstrap settings -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- CSS files are placed at top of the page to be downloaded before the rest of the content and avoid flickering. -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="nvd3-1.8.1/nv.d3.css">
<link rel="stylesheet" href="styles.css">

</head>
<body>
	<noscript>
		<h1>This website requires javascript to function properly</h1>
	</noscript>

	<div class="container">

		<ul id="tab_control" class="nav nav-tabs">
			<li class="active"><a href="#tab_system" data-toggle="tab">System
					Overview</a></li>
			<li><a href="#tab_l2a" data-toggle="tab">L2A Processor</a></li>
			<li><a href="#tab_l3a" data-toggle="tab">L3A Processor</a></li>
			<li><a href="#tab_l3b" data-toggle="tab">L3B Processor</a></li>
			<li><a href="#tab_l4a" data-toggle="tab">L4A Processor</a></li>
			<li><a href="#tab_l4b" data-toggle="tab">L4B Processor</a></li>
			<li><a href="#tab_products" data-toggle="tab">Product
					Availability</a></li>
		</ul>

		<div id="tab_control_content" class="tab-content">
			<!-- System Overview ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade in active" id="tab_system">
			
				<div id="pnl_current_jobs_container"> 
					<div class="panel panel-default" id="pnl_current_jobs">
						<div class="panel-heading">Current Jobs</div>
						<table class="table full_width">
							<tr>
								<th rowspan="2">Id</th>
								<th rowspan="2">Processor</th>
								<th rowspan="2">Site</th>
								<th rowspan="2">Triggered By</th>
								<th rowspan="2">Triggered On</th>
								<th rowspan="2">Status</th>
								<th rowspan="2">Tasks Completed/Running</th>
								<th colspan="2">Current Task</th>
								<th rowspan="2">Actions</th>
							</tr>
							<tr>
								<th>Module</th>
								<th>Tiles Completed/Running</th>
							</tr>
						</table>
					</div>
				</div>
				
				<div id="pnl_server_resources_container">	
					<div class="panel panel-default"  id="pnl_server_resources">
						<div class="panel-heading">Server Resources</div>
					</div>
				</div>
			
			</div>

			<!-- L2A Processor ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_l2a">
					<div class="panel_resources_and_output_container" id="pnl_l2a_resources_and_output_container">
						
						<div class="panel_resources_container" id="pnl_l2a_resources_container">
							<div class="panel panel-default panel_resources" id="pnl_l2a_resources">
								<div class="panel-heading">Resource Utilization</div>
								<table class="table full_width default_panel_style">
									
								</table>
							</div>
						</div>
						
						<div class="panel_output_container" id="pnl_l2a_output_container">
							<div class="panel panel-default panel_output" id="pnl_l2a_output">
								<div class="panel-heading">Output</div>
								<table class="table full_width default_panel_style">
							</table>
							</div>
						</div>
						
					</div>
					
					<div class="panel_configuration_container" id="pnl_l2a_configuration_container">
						<div class="panel panel-default panel_configuration" id="pnl_l2a_configuration">
							<div class="panel-heading">Default Configuration</div>
							<table class="table full_width default_panel_style">
							</table>
						</div>
					</div>
			</div>

			<!-- L3A Processor ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_l3a">
					<div class="panel_resources_and_output_container" id="pnl_l3a_resources_and_output_container">
						
						<div class="panel_resources_container" id="pnl_l3a_resources_container">
							<div class="panel panel-default panel_resources" id="pnl_l3a_resources">
								<div class="panel-heading">Resource Utilization</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
						<div class="panel_output_container" id="pnl_l3a_output_container">
							<div class="panel panel-default panel_output" id="pnl_l3a_output">
								<div class="panel-heading">Output</div>
								<table class="table full_width default_panel_style">
							</table>
							</div>
						</div>
						
					</div>
					
					<div class="panel_configuration_container" id="pnl_l3a_configuration_container">
						<div class="panel panel-default panel_configuration" id="pnl_l3a_configuration">
							<div class="panel-heading">Default Configuration</div>
							<table class="table full_width default_panel_style">
							</table>
						</div>
					</div>
			</div>

			<!-- L3B Processor ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_l3b">
					<div class="panel_resources_and_output_container" id="pnl_l3b_resources_and_output_container">
						
						<div class="panel_resources_container" id="pnl_l3b_resources_container">
							<div class="panel panel-default panel_resources" id="pnl_l3b_resources">
								<div class="panel-heading">Resource Utilization</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
						<div class="panel_output_container" id="pnl_l3b_output_container">
							<div class="panel panel-default panel_output" id="pnl_l3b_output">
								<div class="panel-heading">Output</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
					</div>
					
					<div class="panel_configuration_container" id="pnl_l3b_configuration_container">
						<div class="panel panel-default panel_configuration" id="pnl_l3b_configuration">
							<div class="panel-heading">Default Configuration</div>
							<table class="table full_width default_panel_style">
							</table>
						</div>
					</div>
			</div>

			<!-- L4A Processor ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_l4a">
					<div class="panel_resources_and_output_container" id="pnl_l4a_resources_and_output_container">
						
						<div class="panel_resources_container" id="pnl_l4a_resources_container">
							<div class="panel panel-default panel_resources" id="pnl_l4a_resources">
								<div class="panel-heading">Resource Utilization</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
						<div class="panel_output_container" id="pnl_l4a_output_container">
							<div class="panel panel-default panel_output" id="pnl_l4a_output">
								<div class="panel-heading">Output</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
					</div>
					
					<div class="panel_configuration_container" id="pnl_l4a_configuration_container">
						<div class="panel panel-default panel_configuration" id="pnl_l4a_configuration">
							<div class="panel-heading">Default Configuration</div>
							<table class="table full_width default_panel_style">
							</table>
						</div>
					</div>
			</div>

			<!-- L4B Processor ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_l4b">
					<div class="panel_resources_and_output_container" id="pnl_l4b_resources_and_output_container">
						
						<div class="panel_resources_container" id="pnl_l4b_resources_container">
							<div class="panel panel-default panel_resources" id="pnl_l4b_resources">
								<div class="panel-heading">Resource Utilization</div>
								<table class="table full_width default_panel_style">
								</table>
							</div>
						</div>
						
						<div class="panel_output_container" id="pnl_l4b_output_container">
							<div class="panel panel-default panel_output" id="pnl_l4b_output">
								<div class="panel-heading">Output</div>
								<table class="table full_width default_panel_style">
							</table>
							</div>
						</div>
						
					</div>
					
					<div class="panel_configuration_container" id="pnl_l4b_configuration_container">
						<div class="panel panel-default panel_configuration" id="pnl_l4b_configuration">
							<div class="panel-heading">Default Configuration</div>
							<table class="table full_width default_panel_style">
							</table>
						</div>
					</div>
			</div>

			<!-- Product Availability ----------------------------------------------------------------------------------------------------------------------- -->
			<div class="tab-pane fade" id="tab_products">
						
					<div class="panel panel-default full_width full_height" id="pnl_products">
						<div class="panel-heading smaller_padding">
							<div>Products Available During The Last:
								<div style="display: inline-block;">
									<div class="dropdown">
										<button class="btn btn-default btn-sm dropdown-toggle" type="button" data-toggle="dropdown"> 1 Hour
									  		<span class="caret"></span>
										</button>
										<ul class="dropdown-menu">
											<li><a href="#">6 Hours</a></li>
											<li><a href="#">12 Hours</a></li>
											<li><a href="#">1 Day</a></li>
											<li><a href="#">7 Days</a></li>
											<li><a href="#">14 Days</a></li>
											<li><a href="#">30 Days</a></li>
										</ul>
									</div>
								</div> 
							</div>
						</div>
						<table class="table full_width full_height">
						</table>
					</div>
					
			</div>
		</div>

	<!-- Scripts are placed at the bottom of the page to be downloaded after the rest of the content and avoid delays in page loading. -->
	<script	src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.4.min.js"></script>
	<script	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
	<script src="flot-0.8.3/jquery.flot.min.js"></script>
	<script src="flot-0.8.3/jquery.flot.time.min.js"></script>
	<script src="nvd3-1.8.1/nv.d3.min.js"></script>
	<script src="processing.js"></script>

	<script type="text/javascript">
		function gd(year, month, day, hour, minute, second) {
	        return new Date(year, month, day, hour, minute, second).getTime();
	    }
	
		var json_data = {
				"current_jobs": [{
					"id": 7894,
					"processor": "L2A Atmospheric Corrections",
					"site": "Argentina,	San Antonio de Areco",
					"triggered_by": "Available Product",
					"triggered_on": "2015-07-13 11:47:58",
					"status": "Running",
					"tasks_completed": 0,
					"tasks_remaining": 4,
					"current_task_module": "Test module 3",
					"current_task_steps_completed": 17,
					"current_task_steps_remaining": 144,
					"actions": [1, 3, 4]
				}, {
					"id": 96345,
					"processor": "L3B Vegetation Status",
					"site": "Madagascar, Antsirabe",
					"triggered_by": "Scheduler",
					"triggered_on": "2015-07-13 12:23:45",
					"status": "Needs Input",
					"tasks_completed": 5,
					"tasks_remaining": 15,
					"current_task_module": "Test module with long name",
					"current_task_steps_completed": 0,
					"current_task_steps_remaining": 1,
					"actions": [2, 3, 4]
				}],
				"server_resources" : [{
					"name": "Node 1",
					"cpu_now": 78,
					"cpu_history": [[gd(2015,07,16,14,29,30),22], [gd(2015,07,16,14,29,35),43], [gd(2015,07,16,14,29,40),27], [gd(2015,07,16,14,29,45),56], [gd(2015,07,16,14,29,50),28]],
					"ram_now": 2.34,
					"ram_available": 4,
					"ram_history": [[gd(2015,07,16,14,29,30),2.02], [gd(2015,07,16,14,29,35),1.56], [gd(2015,07,16,14,29,40),3.98], [gd(2015,07,16,14,29,45),1.19], [gd(2015,07,16,14,29,50),2.32]],
					"swap_now": 0.72,
					"swap_available": 16,
					"swap_history": [[gd(2015,07,16,14,29,30),1.02], [gd(2015,07,16,14,29,35),4.56], [gd(2015,07,16,14,29,40),2.98], [gd(2015,07,16,14,29,45),6.19], [gd(2015,07,16,14,29,50),4.32]],
					"disk_used": 1.67,
					"disk_available": 3,
					"load_1min": 2.23,
					"load_5min": 1.34,
					"load_15min": 2.42,
					"load_1min_history": [[gd(2015,07,16,14,29,30),1.23], [gd(2015,07,16,14,29,35),5.67], [gd(2015,07,16,14,29,40),2.34], [gd(2015,07,16,14,29,45),0.14], [gd(2015,07,16,14,29,50),2.45]],
					"load_5min_history": [[gd(2015,07,16,14,29,30),4.23], [gd(2015,07,16,14,29,35),1.67], [gd(2015,07,16,14,29,40),5.34], [gd(2015,07,16,14,29,45),0.94], [gd(2015,07,16,14,29,50),4.45]],
					"load_15min_history": [[gd(2015,07,16,14,29,30),2.23], [gd(2015,07,16,14,29,35),3.67], [gd(2015,07,16,14,29,40),1.34], [gd(2015,07,16,14,29,45),0.84], [gd(2015,07,16,14,29,50),3.45]]
				}, {
					"name": "Node 2",
					"cpu_now": 23,
					"cpu_history": [[gd(2015,07,16,14,29,30),22], [gd(2015,07,16,14,29,35),43], [gd(2015,07,16,14,29,40),27], [gd(2015,07,16,14,29,45),56], [gd(2015,07,16,14,29,50),98]],
					"ram_now": 2.34,
					"ram_available": 4,
					"ram_history": [[gd(2015,07,16,14,29,30),2.02], [gd(2015,07,16,14,29,35),1.56], [gd(2015,07,16,14,29,40),3.98], [gd(2015,07,16,14,29,45),1.19], [gd(2015,07,16,14,29,50),2.32]],
					"swap_now": 0.72,
					"swap_available": 16,
					"swap_history": [[gd(2015,07,16,14,29,30),1.02], [gd(2015,07,16,14,29,35),4.56], [gd(2015,07,16,14,29,40),2.98], [gd(2015,07,16,14,29,45),6.19], [gd(2015,07,16,14,29,50),4.32]],
					"disk_used": 1.67,
					"disk_available": 3,
					"load_1min": 2.23,
					"load_5min": 1.34,
					"load_15min": 2.42,
					"load_1min_history": [[gd(2015,07,16,14,29,30),1.23], [gd(2015,07,16,14,29,35),5.67], [gd(2015,07,16,14,29,40),2.34], [gd(2015,07,16,14,29,45),0.14], [gd(2015,07,16,14,29,50),2.45]],
					"load_5min_history": [[gd(2015,07,16,14,29,30),4.23], [gd(2015,07,16,14,29,35),1.67], [gd(2015,07,16,14,29,40),5.34], [gd(2015,07,16,14,29,45),0.94], [gd(2015,07,16,14,29,50),4.45]],
					"load_15min_history": [[gd(2015,07,16,14,29,30),2.23], [gd(2015,07,16,14,29,35),3.67], [gd(2015,07,16,14,29,40),1.34], [gd(2015,07,16,14,29,45),0.84], [gd(2015,07,16,14,29,50),3.45]]
				}],
				"l2a_statistics" : {
					"resources": [ ["Last Run On", "2015-07-20 16:11:23"], ["Average Duration", "03.12:22"]],
					"output": [["Number Of Products", 23], ["Average Tile per Product", 6]],
					"configuration": [["Param 1", "Value 1"], ["Param 2", "Value 2"]]
				},
				"l3a_statistics" : {
					"resources": [ ["Last Run On", "2015-07-20 16:11:23"], ["Average Duration", "03.12:22"]],
					"output": [["Number Of Products", 23], ["Average Tile per Product", 6]],
					"configuration": [["Param 1", "Value 1"], ["Param 2", "Value 2"]]
				},
				"l3b_statistics" : {
					"resources": [ ["Last Run On", "2015-07-20 16:11:23"], ["Average Duration", "03.12:22"]],
					"output": [["Number Of Products", 23], ["Average Tile per Product", 6]],
					"configuration": [["Param 1", "Value 1"], ["Param 2", "Value 2"]]
				},
				"l4a_statistics" : {
					"resources": [ ["Last Run On", "2015-07-20 16:11:23"], ["Average Duration", "03.12:22"]],
					"output": [["Number Of Products", 23], ["Average Tile per Product", 6]],
					"configuration": [["Param 1", "Value 1"], ["Param 2", "Value 2"]]
				},
				"l4b_statistics" : {
					"resources": [ ["Last Run On", "2015-07-20 16:11:23"], ["Average Duration", "03.12:22"]],
					"output": [["Number Of Products", 23], ["Average Tile per Product", 6]],
					"configuration": [["Param 1", "Value 1"], ["Param 2", "Value 2"]]
				},
				"products" : {
				    key: 'Products',
				    values: [
				      {
				        key: "L2A Products",
				        values: [
				          {
				          	name: "Product 1",
				            date: gd(2015,07,16,14,29,30),
				            info: ["Info 1", "Info 2", "Info 3"]
				          },
				          {
				        	name: "Product 2",
					      	date: gd(2015,07,16,14,29,30),
					        info: ["Info 1", "Info 2", "Info 3"] 
				          }]
				      },
				      {
				        key: "L3A Products",
				        values: [
				          {
				          	name: "Product 3",
				            date: gd(2015,07,16,14,29,30),
				            info: ["Info 1", "Info 2", "Info 3"]
				          },
				          {
				        	name: "Product 4",
					      	date: gd(2015,07,16,14,29,30),
					        info: ["Info 1", "Info 2", "Info 3"] 
				          }]
				      }]
				}
			};	
	
		$(document).ready(function() {			
			update_current_jobs(json_data);
			update_server_resources_layout(json_data);
			update_server_resources(json_data);
			update_l2a_statistics(json_data);
			update_l3a_statistics(json_data);
			update_l3b_statistics(json_data);
			update_l4a_statistics(json_data);
			update_l4b_statistics(json_data);
		})
	</script>
</body>
</html>
